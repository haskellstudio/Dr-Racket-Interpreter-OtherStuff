<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0052)https://cgi.soic.indiana.edu/~c311/doku.php?id=lp-a1 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="google-site-verification" content="CHpL8-yKEGFx7Gy37uNcU2lz9oRZydQdifkiJNj6-P4">
  
  <title>
    C311/B521/A596 Programming Languages    [Assignment 11: Type Inference]
  </title>

  <meta name="generator" content="DokuWiki Release 2009-02-14b">
<meta name="robots" content="index,follow">
<meta name="date" content="2015-04-14T17:14:18-0400">
<meta name="keywords" content="lp-a1">
<link rel="search" type="application/opensearchdescription+xml" href="https://cgi.soic.indiana.edu/~c311/lib/exe/opensearch.php" title="C311/B521/A596 Programming Languages">
<link rel="start" href="https://cgi.soic.indiana.edu/~c311/">
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="https://cgi.soic.indiana.edu/~c311/feed.php">
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="https://cgi.soic.indiana.edu/~c311/feed.php?mode=list&amp;ns=">
<link rel="alternate" type="text/html" title="Plain HTML" href="https://cgi.soic.indiana.edu/~c311/doku.php?do=export_xhtml&amp;id=lp-a1">
<link rel="stylesheet" media="all" type="text/css" href="./C311_B521_A596 Programming Languages [Assignment 11_ Type Inference]_files/css.php">
<link rel="stylesheet" media="screen" type="text/css" href="./C311_B521_A596 Programming Languages [Assignment 11_ Type Inference]_files/css(1).php">
<link rel="stylesheet" media="print" type="text/css" href="./C311_B521_A596 Programming Languages [Assignment 11_ Type Inference]_files/css(2).php">
<script type="text/javascript" charset="utf-8" src="./C311_B521_A596 Programming Languages [Assignment 11_ Type Inference]_files/js.php"></script>

  <link rel="shortcut icon" href="https://cgi.soic.indiana.edu/~c311/lib/tpl/doogiestpl/images/favicon.ico">

  </head>



<body>
<div class="dokuwiki">
  
  <div class="stylehead">

    <div class="header">
      <div class="header_left"></div>
      <div class="logo">
        <a href="https://cgi.soic.indiana.edu/~c311/doku.php" name="dokuwiki__top" id="dokuwiki__top" accesskey="h" title="[ALT+H]">C311/B521/A596 Programming Languages</a>      </div>

      <div id="tabnavi" class="tabnavi">
	    <ul>
<li><a href="https://cgi.soic.indiana.edu/~c311/doku.php?id=home">Home</a></li>
<li><a href="https://cgi.soic.indiana.edu/~c311/doku.php?id=course-policies">Policies</a></li>
<li><a href="https://cgi.soic.indiana.edu/~c311/doku.php?id=instructors">Instructors</a></li>
<li><a href="https://cgi.soic.indiana.edu/~c311/doku.php?id=resources">Resources</a></li>
<li><a href="https://cgi.soic.indiana.edu/~c311/doku.php?id=schedule">Schedule</a></li>
<li><a href="https://cgi.soic.indiana.edu/~c311/doku.php?id=assignments">Assignments</a></li>
<li><a href="https://cgi.soic.indiana.edu/~c311/doku.php?id=b621">B621</a></li>
</ul>
	  </div>
	  
	  <div class="clearer"></div>
      	</div>  
  </div>
    
  
   <div style="float: right;">
            <form class="button btn_login" method="get" action="https://cgi.soic.indiana.edu/~c311/doku.php"><div class="no"><input type="hidden" name="do" value="login"><input type="hidden" name="sectok" value="bb41d96766a4f618105208cecf4ca075"><input type="hidden" name="id" value="lp-a1"><input type="submit" value="Login" class="button" title="Login"></div></form>       &nbsp;  &nbsp;  &nbsp;
   </div>
  <div class="clearer">&nbsp;</div>


  <div class="page">
    <!-- ......... wikipage start ......... -->
    


<h1><a name="assignment-11type-inference" id="assignment-11type-inference">Assignment 11: Type Inference</a></h1>
<div class="level1">

<p>
<!---
&lt;blockquote Lewis Carroll, Through The Looking-Glass&gt;
&#039;Contrariwise,&#039; continued Tweedledee, &#039;if it was so, it might be; and if it were so, it would be; but as it isn&#039;t, it ain&#039;t. That&#039;s logic.&#039; 
&lt;/blockquote&gt;
--->
</p>

<blockquote cite="./C311_B521_A596 Programming Languages [Assignment 11_ Type Inference]_files/John McCarthy, 1967" class="blockquote-plugin">
<p>
It is reasonable to hope that the relationship between computation and logic in the next century will be as fruitful as that between calculus and physics in the last.

</p>

</blockquote>

</div>

<h2><a name="assignment" id="assignment">Assignment</a></h2>
<div class="level2">

</div>

<h2><a name="part-i" id="part-i">Part I</a></h2>
<div class="level2">

<p>

You should print and complete <a href="https://cgi.soic.indiana.edu/~c311/lib/exe/fetch.php?media=a11-parti.pdf" class="media mediafile mf_pdf" title="a11-parti.pdf">a11-partI</a>. This is optional, and will not be graded, but reflects material you <em>will</em> need to know for the final exam. It asks you to infer by hand the types of expressions as we did in class on Tuesday. 
</p>

</div>

<h2><a name="part-ii" id="part-ii">Part II</a></h2>
<div class="level2">

<p>

The rest of your assignment this week is to complete your own type inferencer and inhabiter in miniKanren. <strong>You should start with</strong> <a href="https://cgi.soic.indiana.edu/~c311/lib/exe/fetch.php?media=a11.rkt" class="media mediafile mf_rkt" title="a11.rkt">a11.rkt</a>, a version of inferencer we began on Thursday, and add to it <code>*</code>, <code>not</code>, <code>zero?</code>, <code>sub1</code>, and <code>fix</code>. To be clear, your solution should not involve <code>match</code> at all; it should be written entirely in miniKanren. You can use the <a href="https://cgi.soic.indiana.edu/~c311/lib/exe/fetch.php?media=a11-student-tests.rkt" class="media mediafile mf_rkt" title="a11-student-tests.rkt">a11-student-tests.rkt</a> file to test your file.
</p>

<p>
You may find the following <a href="http://www.cs.indiana.edu/classes/c311/minitypes.pdf" class="urlextern" title="http://www.cs.indiana.edu/classes/c311/minitypes.pdf" rel="nofollow">"old-school" notes </a> from Dan, Will, and David of some use. 
</p>

<p>
Your extended inferencer should pass all of the test cases provided for the regular portion of the assignment. Honors students and real go-getters should adjust the expectations accordingly.
</p>

<p>
<!---
Extend the given type inferencer with the definitions of booleans, &#039;&#039;sub1&#039;&#039;, &#039;&#039;zero?&#039;&#039;, &#039;&#039;+&#039;&#039;, &#039;&#039;not&#039;&#039; and &#039;&#039;if&#039;&#039;. Your  should pass all of the test cases provided with {{:a11.scm|a11.scm}}. Be sure and get the most up-to-date version of [[https://raw.github.com/jasonhemann/miniKanren/master/mk.scm|mk.scm]].
--->
</p>

<p>
To avoid divergence for some of the tests, you must carefully order goals within a conjunction to “fail fast”. Keep these rules in mind:

</p>
<ul>
<li class="level1"><div class="li"> Simple unifications should come before recursive calls. For example, <code>(== 5 x)</code> should come before <code>(foo y z)</code>.</div>
</li>
<li class="level1"><div class="li"> Recursive calls with instantiated arguments should come before recursive calls with uninstantiated arguments. </div>
</li>
</ul>

<p>
    For example, <code>(foo `(,x ,y ,z) 5)</code> should come before <code>(foo u v)</code>, assuming <code>x</code>, <code>y</code>, <code>z</code>, <code>u</code>, and <code>v</code> are fresh.
</p>
<pre class="code lisp"><span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>q<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> #t q<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span>Bool<span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>q<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> <span class="nu0">17</span> q<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span>Nat<span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>q<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span>zero? <span class="nu0">24</span><span class="br0">)</span> q<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span>Bool<span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>q<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span>zero? <span class="br0">(</span>sub1 <span class="nu0">24</span><span class="br0">)</span><span class="br0">)</span> q<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span>Bool<span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>q<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="kw1">not</span> <span class="br0">(</span>zero? <span class="br0">(</span>sub1 <span class="nu0">24</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> q<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span>Bool<span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>q<span class="br0">)</span>
    <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span>zero? <span class="br0">(</span>sub1 <span class="br0">(</span>sub1 <span class="nu0">18</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> q<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span>Bool<span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>q<span class="br0">)</span>
    <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span>  '<span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>n<span class="br0">)</span> <span class="br0">(</span><span class="kw1">if</span> <span class="br0">(</span>zero? n<span class="br0">)</span> n n<span class="br0">)</span><span class="br0">)</span> q<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span><span class="br0">(</span>Nat <span class="sy0">-&gt;</span> Nat<span class="br0">)</span><span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>q<span class="br0">)</span>
    <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>n<span class="br0">)</span> <span class="br0">(</span>zero? n<span class="br0">)</span><span class="br0">)</span> <span class="nu0">5</span><span class="br0">)</span> q<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span>Bool<span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>q<span class="br0">)</span>
    <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="kw1">if</span> <span class="br0">(</span>zero? <span class="nu0">24</span><span class="br0">)</span> <span class="nu0">3</span> <span class="nu0">4</span><span class="br0">)</span> q<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span>Nat<span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>q<span class="br0">)</span>
    <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="kw1">if</span> <span class="br0">(</span>zero? <span class="nu0">24</span><span class="br0">)</span> <span class="br0">(</span>zero? <span class="nu0">3</span><span class="br0">)</span> <span class="br0">(</span>zero? <span class="nu0">4</span><span class="br0">)</span><span class="br0">)</span> q<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span>Bool<span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>q<span class="br0">)</span>
    <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>x<span class="br0">)</span> <span class="br0">(</span>sub1 x<span class="br0">)</span><span class="br0">)</span> q<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span><span class="br0">(</span>Nat <span class="sy0">-&gt;</span> Nat<span class="br0">)</span><span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>q<span class="br0">)</span>
    <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>a<span class="br0">)</span> <span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>x<span class="br0">)</span> <span class="br0">(</span><span class="sy0">+</span> a x<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> q<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span><span class="br0">(</span>Nat <span class="sy0">-&gt;</span> <span class="br0">(</span>Nat <span class="sy0">-&gt;</span> Nat<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>q<span class="br0">)</span>
    <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>f<span class="br0">)</span>
               <span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>x<span class="br0">)</span>
                 <span class="br0">(</span><span class="br0">(</span>f x<span class="br0">)</span> x<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
         q<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span><span class="br0">(</span><span class="br0">(</span>_.0 <span class="sy0">-&gt;</span> <span class="br0">(</span>_.0 <span class="sy0">-&gt;</span> _.1<span class="br0">)</span><span class="br0">)</span> <span class="sy0">-&gt;</span> <span class="br0">(</span>_.0 <span class="sy0">-&gt;</span> _.1<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>q<span class="br0">)</span>
    <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span>sub1 <span class="br0">(</span>sub1 <span class="br0">(</span>sub1 <span class="nu0">6</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> q<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span>Nat<span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run <span class="nu0">1</span> <span class="br0">(</span>q<span class="br0">)</span>
    <span class="br0">(</span>fresh <span class="br0">(</span>t<span class="br0">)</span>
      <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>f<span class="br0">)</span> <span class="br0">(</span>f f<span class="br0">)</span><span class="br0">)</span> t<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span><span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span><span class="kw1">length</span> <span class="br0">(</span>run <span class="nu0">20</span> <span class="br0">(</span>q<span class="br0">)</span>
             <span class="br0">(</span>fresh <span class="br0">(</span>lam a b<span class="br0">)</span>
               <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> `<span class="br0">(</span><span class="br0">(</span>,lam <span class="br0">(</span>,a<span class="br0">)</span> ,b<span class="br0">)</span> <span class="nu0">5</span><span class="br0">)</span> 'Nat<span class="br0">)</span>
               <span class="br0">(</span><span class="sy0">==</span> `<span class="br0">(</span>,lam <span class="br0">(</span>,a<span class="br0">)</span> ,b<span class="br0">)</span> q<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
<span class="nu0">20</span>
<span class="sy0">&gt;</span> <span class="br0">(</span><span class="kw1">length</span> <span class="br0">(</span>run <span class="nu0">30</span> <span class="br0">(</span>q<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> q 'Nat<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
<span class="nu0">30</span>
<span class="sy0">&gt;</span> <span class="br0">(</span><span class="kw1">length</span> <span class="br0">(</span>run <span class="nu0">30</span> <span class="br0">(</span>q<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> q '<span class="br0">(</span>Nat <span class="sy0">-&gt;</span> Nat<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
<span class="nu0">30</span>
<span class="sy0">&gt;</span> <span class="br0">(</span><span class="kw1">length</span> <span class="br0">(</span>run <span class="nu0">500</span> <span class="br0">(</span>q<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> q '<span class="br0">(</span>Nat <span class="sy0">-&gt;</span> Nat<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
<span class="nu0">500</span>
<span class="co1">;; At this point, stop and take a look at maybe the 500th </span>
<span class="co1">;; program you generate</span>
<span class="co1">;; (last (run 500 (q) (!- '() q '(Nat -&gt; Nat))))</span>
<span class="co1">;; You should be amazed at how quickly it's generating them.</span>
<span class="co1">;; If it isn't fast, consider reordering your clauses. </span>
<span class="sy0">&gt;</span> <span class="br0">(</span><span class="kw1">length</span> <span class="br0">(</span>run <span class="nu0">30</span> <span class="br0">(</span>q<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> q '<span class="br0">(</span>Bool <span class="sy0">-&gt;</span> Nat<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
<span class="nu0">30</span>
<span class="sy0">&gt;</span> <span class="br0">(</span><span class="kw1">length</span> <span class="br0">(</span>run <span class="nu0">30</span> <span class="br0">(</span>q<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> q '<span class="br0">(</span>Nat <span class="sy0">-&gt;</span> <span class="br0">(</span>Nat <span class="sy0">-&gt;</span> Nat<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
<span class="nu0">30</span>
<span class="sy0">&gt;</span> <span class="br0">(</span><span class="kw1">length</span> <span class="br0">(</span>run <span class="nu0">100</span> <span class="br0">(</span>q<span class="br0">)</span>
             <span class="br0">(</span>fresh <span class="br0">(</span>e t<span class="br0">)</span>
               <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> e t<span class="br0">)</span>
               <span class="br0">(</span><span class="sy0">==</span> `<span class="br0">(</span>,e ,t<span class="br0">)</span> q<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
<span class="nu0">100</span>
<span class="sy0">&gt;</span> <span class="br0">(</span><span class="kw1">length</span> <span class="br0">(</span>run <span class="nu0">100</span> <span class="br0">(</span>q<span class="br0">)</span>
             <span class="br0">(</span>fresh <span class="br0">(</span>g e t<span class="br0">)</span>
               <span class="br0">(</span><span class="sy0">!-</span> g e t<span class="br0">)</span>
               <span class="br0">(</span><span class="sy0">==</span> `<span class="br0">(</span>,g ,e ,t<span class="br0">)</span> q<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
<span class="nu0">100</span>
<span class="sy0">&gt;</span> <span class="br0">(</span><span class="kw1">length</span>
   <span class="br0">(</span>run <span class="nu0">100</span> <span class="br0">(</span>q<span class="br0">)</span>
     <span class="br0">(</span>fresh <span class="br0">(</span>g v<span class="br0">)</span>
       <span class="br0">(</span><span class="sy0">!-</span> g `<span class="br0">(</span>var ,v<span class="br0">)</span> 'Nat<span class="br0">)</span>
       <span class="br0">(</span><span class="sy0">==</span> `<span class="br0">(</span>,g ,v<span class="br0">)</span> q<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
<span class="nu0">100</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run <span class="nu0">1</span> <span class="br0">(</span>q<span class="br0">)</span>
       <span class="br0">(</span>fresh <span class="br0">(</span>g<span class="br0">)</span>
	 <span class="br0">(</span><span class="sy0">!-</span> g
	      '<span class="br0">(</span><span class="br0">(</span>fix <span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span><span class="sy0">!</span><span class="br0">)</span>
		       <span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>n<span class="br0">)</span>
			 <span class="br0">(</span><span class="kw1">if</span> <span class="br0">(</span>zero? n<span class="br0">)</span>
			     <span class="nu0">1</span>
			     <span class="br0">(</span><span class="sy0">*</span> n <span class="br0">(</span><span class="sy0">!</span> <span class="br0">(</span>sub1 n<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
		<span class="nu0">5</span><span class="br0">)</span>
	      q<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span>Nat<span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run <span class="nu0">1</span> <span class="br0">(</span>q<span class="br0">)</span>
       <span class="br0">(</span>fresh <span class="br0">(</span>g<span class="br0">)</span>
	 <span class="br0">(</span><span class="sy0">!-</span> g
	      '<span class="br0">(</span><span class="br0">(</span>fix <span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span><span class="sy0">!</span><span class="br0">)</span>
		       <span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>n<span class="br0">)</span>
			 <span class="br0">(</span><span class="sy0">*</span> n <span class="br0">(</span><span class="sy0">!</span> <span class="br0">(</span>sub1 n<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
		<span class="nu0">5</span><span class="br0">)</span>
	      q<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span>Nat<span class="br0">)</span>
<span class="sy0">&gt;</span></pre>
<p>

<!---
  * You can complete this portion of the assignment by adding fewer than 30 lines of code to the provided file.
--->
</p>

</div>

<h2><a name="brainteaser" id="brainteaser">Brainteaser</a></h2>
<div class="level2">

<p>
Extend your type inferencer to recognize <em>pair types</em>. 
You will need to add support for a <code>pairof</code> type to the type inferencer such that the following tests pass. 
</p>
<pre class="code lisp"><span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>q<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="kw1">cons</span> <span class="br0">(</span>zero? <span class="nu0">1</span><span class="br0">)</span> <span class="br0">(</span>zero? 0<span class="br0">)</span><span class="br0">)</span> q<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span><span class="br0">(</span>pairof Bool Bool<span class="br0">)</span><span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>q<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="kw1">cons</span> <span class="br0">(</span>zero? <span class="nu0">1</span><span class="br0">)</span> <span class="br0">(</span><span class="kw1">cons</span> <span class="br0">(</span>zero? <span class="nu0">1</span><span class="br0">)</span> <span class="br0">(</span>zero? 0<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> q<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span><span class="br0">(</span>pairof Bool <span class="br0">(</span>pairof Bool Bool<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>t<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>x<span class="br0">)</span> <span class="br0">(</span><span class="kw1">cons</span> x x<span class="br0">)</span><span class="br0">)</span> t<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span><span class="br0">(</span>_.0 <span class="sy0">-&gt;</span> <span class="br0">(</span>pairof _.0 _.0<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>t<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>x<span class="br0">)</span> <span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>y<span class="br0">)</span> <span class="br0">(</span><span class="kw1">cons</span> <span class="br0">(</span>zero? x<span class="br0">)</span> <span class="br0">(</span><span class="sy0">+</span> x y<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> t<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span><span class="br0">(</span>Nat <span class="sy0">-&gt;</span> <span class="br0">(</span>Nat <span class="sy0">-&gt;</span> <span class="br0">(</span>pairof Bool Nat<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span></pre>
<p>
Once you've done the above, add two more clauses to the type inferencer such that the following tests pass.  (By the way, these two new lines will be quite similar to each other!) 
</p>
<pre class="code lisp"><span class="co1">;; a function that accepts a pair of an Nat and anything</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>t<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>x<span class="br0">)</span> <span class="br0">(</span>zero? <span class="br0">(</span><span class="kw1">car</span> x<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> t<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span><span class="br0">(</span><span class="br0">(</span>pairof Nat _.0<span class="br0">)</span> <span class="sy0">-&gt;</span> Bool<span class="br0">)</span><span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>t<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>x<span class="br0">)</span> <span class="br0">(</span>zero? <span class="br0">(</span><span class="kw1">car</span> x<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">(</span><span class="kw1">cons</span> 0 <span class="nu0">1</span><span class="br0">)</span><span class="br0">)</span> t<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span>Bool<span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>t<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>x<span class="br0">)</span> <span class="br0">(</span>zero? <span class="br0">(</span><span class="kw1">car</span> x<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">(</span><span class="kw1">cons</span> 0 #f<span class="br0">)</span><span class="br0">)</span> t<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span>Bool<span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>t<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>x<span class="br0">)</span> <span class="br0">(</span>zero? <span class="br0">(</span><span class="kw1">car</span> x<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">(</span><span class="kw1">cons</span> #f 0<span class="br0">)</span><span class="br0">)</span> t<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span><span class="br0">)</span>
<span class="co1">;; a function that accepts a pair of anything and an Nat</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>t<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>x<span class="br0">)</span> <span class="br0">(</span>zero? <span class="br0">(</span><span class="kw1">cdr</span> x<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> t<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span><span class="br0">(</span><span class="br0">(</span>pairof _.0 Nat<span class="br0">)</span> <span class="sy0">-&gt;</span> Bool<span class="br0">)</span><span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>t<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>x<span class="br0">)</span> <span class="br0">(</span>zero? <span class="br0">(</span><span class="kw1">cdr</span> x<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">(</span><span class="kw1">cons</span> 0 <span class="nu0">1</span><span class="br0">)</span><span class="br0">)</span> t<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span>Bool<span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>t<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>x<span class="br0">)</span> <span class="br0">(</span>zero? <span class="br0">(</span><span class="kw1">cdr</span> x<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">(</span><span class="kw1">cons</span> 0 #f<span class="br0">)</span><span class="br0">)</span> t<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span><span class="br0">)</span>
<span class="sy0">&gt;</span> <span class="br0">(</span>run<span class="sy0">*</span> <span class="br0">(</span>t<span class="br0">)</span> <span class="br0">(</span><span class="sy0">!-</span> '<span class="br0">(</span><span class="br0">)</span> '<span class="br0">(</span><span class="br0">(</span><span class="kw1">lambda</span> <span class="br0">(</span>x<span class="br0">)</span> <span class="br0">(</span>zero? <span class="br0">(</span><span class="kw1">cdr</span> x<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">(</span><span class="kw1">cons</span> #f 0<span class="br0">)</span><span class="br0">)</span> t<span class="br0">)</span><span class="br0">)</span>
<span class="br0">(</span>Bool<span class="br0">)</span></pre>
<p>
<!---
===== Really and Truly Optional Brainteaser =====

You may notice that &#039;&#039;not-in-envo&#039;&#039; is doing something very similar to what &#039;&#039;absento&#039;&#039; can do. &#039;&#039;not-in-envo&#039;&#039;, however, is a //relation//, whereas &#039;&#039;absento&#039;&#039; is a //constraint//. Consider the difference between the following 

&lt;code lisp&gt;
&gt; (run 10 (q) (fresh (a b) (absento a b) (== `(,a ,b) q)))
(((_.0 _.1) (absento (_.0 _.1))))
&gt; (run 5 (q) (fresh (a b) (not-in-envo a b) (== `(,a ,b) q)))
((_.0 ())
  ((_.0 ((_.1 . _.2))) (=/= ((_.1 . _.0))))
  ((_.0 ((_.1 . _.2) (_.3 . _.4)))
    (=/= ((_.1 . _.0)) ((_.3 . _.0))))
  ((_.0 ((_.1 . _.2) (_.3 . _.4) (_.5 . _.6)))
    (=/= ((_.1 . _.0)) ((_.3 . _.0)) ((_.5 . _.0))))
  ((_.0 ((_.1 . _.2) (_.3 . _.4) (_.5 . _.6) (_.7 . _.8)))
    (=/= ((_.1 . _.0))
         ((_.3 . _.0))
         ((_.5 . _.0))
         ((_.7 . _.0)))))
&lt;/code&gt;

&#039;&#039;not-in-envo&#039;&#039; is a recursive relation. We can ask it for 5, 10, 1000, etc. ways that &#039;&#039;a&#039;&#039; can bear the &#039;&#039;not-in-envo&#039;&#039; relationship to &#039;&#039;b&#039;&#039;, and we&#039;ll get them. Whereas &#039;&#039;absento&#039;&#039; is a constraint. We bundle up the infinitely many possible ways for &#039;&#039;a&#039;&#039; to be absent from &#039;&#039;b&#039;&#039; in that single answer, and there aren&#039;t any more. 

That certainly sounds like it&#039;d be better, but &#039;&#039;absento&#039;&#039; and &#039;&#039;not-in-envo&#039;&#039; don&#039;t work quite the same way. We&#039;d want some way to mandate that x not be in the first part of the alist, but it could well be in the second part. One technique to achieve this would be to split the environment into two -- one a list of terms, and the other a list of types. 
--->
</p>

<p>
<!---      
==== Brainteaser 1: Union Types ====
EDIT: Some people had asked for more information for this question. My suggestion would be to consult Pierce&#039;s &#039;&#039;Types and Programming Languages&#039;&#039; -- there are physical and electronic copies available from the IU Library. Consult section 11.9.

Your task will be to add a type for [[http://en.wikipedia.org/wiki/Disjoint_union|disjoint unions]]. We can treat a type as a set of expressions that would have that type. The disjoint union type is a union of two types with a tag to represent the set from which the type originated. 

You will add the operators &#039;&#039;left&#039;&#039;, &#039;&#039;right&#039;&#039;, and &#039;&#039;type-case&#039;&#039;. The following examples should show you the semantics of these operators. Your task will be to extend the type inferencer appropriately.

&lt;code lisp&gt;

&gt; (type-case (left 5)
      [Int 1]
      [Bool 20])

(left 1)

&gt; ((lambda (x) 
      (type-case (type-case x
                    [Bool 20]
                    [Int #f])
         [Int 10]
         [Bool 6])) 
   (right 5))

(right 6)

&lt;/code&gt;


==== Tough Brainteaser ====
As we noted in lecture, the simply-typed lambda calculus is strongly-normalizing. From this, it followed that types cannot be found for fixed-point combinators such as Omega. However, you can explicitly add recursion to our language by including a special operator &#039;&#039;fix&#039;&#039;. After doing so, you should be able to pass the following tests below.

&lt;code lisp&gt; 
&gt; (run 1 (q)
    (fresh (g)
      (!- g
           &#039;((fix (lambda (!)
                           (lambda (n)
                             (if (zero? n)
                                 1
                                 (* n (! (sub1 n)))))))
                    5)
           q)))
(int)
&lt;/code&gt;

The following test demonstrates an interesting property: just because a program typechecks doesn&#039;t mean it will terminate.
&lt;code lisp&gt;

&gt; (define fix
    (lambda (f)
      (letrec ([g (lambda (x)
                    ((f g) x))])
         g)))

&gt; (run 1 (q)
    (fresh (g)
      (!-o g
           &#039;((fix (lambda (!)
                           (lambda (n)
                             (* n (! (sub1 n))))))
                    5)
           q)))

(int)
&lt;/code&gt; 
---->
</p>

</div>

<h3><a name="just-dessertlet-polymorphism" id="just-dessertlet-polymorphism">Just Dessert: Let Polymorphism</a></h3>
<div class="level3">

<p>

Extend the type inferencer so that the following type is inferred:
</p>
<pre class="code">&gt; (run* (q)
    (!-o '() '(let ([f (lambda (x) x)])
                       (if (f #t) (f (cons (f 4) 5)) (f (cons 5 (f 6)))))
         q))
((pairof Nat Nat))
</pre>

</div>

    <!-- ......... wikipage stop  ......... -->
  </div>

  <div class="clearer">&nbsp;</div>

  
 
  <!--  footer -->  
  <div class="stylefoot">

        <div class="meta">
      <div class="doc">
		<p>lp-a1.txt · Last modified: 2015/04/14 17:14 by jhemann</p>
      </div>
   </div>

    <div>
       <!--  breadcrumbs and search -->
	  	
	  

       
      <div class="clearer"></div>
    </div>

  </div>

</div>





<div class="no"><img src="./C311_B521_A596 Programming Languages [Assignment 11_ Type Inference]_files/indexer.php" width="1" height="1" alt=""></div>


</body></html>